#!/bin/bash

echo "Building Spring Boot application for production..."

# Clean et build du projet Maven
./mvnw clean package -DskipTests

# Vérifier si le jar existe
JAR_FILE=$(ls target/*.jar | head -n 1)
if [ ! -f "$JAR_FILE" ]; then
    echo "Erreur: Le fichier JAR n'a pas été généré."
    exit 1
fi

echo "Jar trouvé: $JAR_FILE"

# Build de l'image Docker
docker build -t mdrassa-api .

echo "Build Docker terminé !"
